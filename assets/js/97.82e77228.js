(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{448:function(t,e,a){"use strict";a.r(e);var s=a(14),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"_5-6-paginate-pagination"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-paginate-pagination"}},[t._v("#")]),t._v(" 5.6 Paginate Pagination")]),t._v(" "),e("h3",{attrs:{id:"_1-common-paginate-usage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-common-paginate-usage"}},[t._v("#")]),t._v(" 1. Common paginate Usage")]),t._v(" "),e("p",[t._v("Both the Model and Db provide the most commonly used pagination API: "),e("code",[t._v("paginate(int pageNumber, int pageSize, String select, String sqlExceptSelect, Object... paras)")]),t._v(".")]),t._v(" "),e("p",[t._v("The parameters respectively represent: the current page number, number of data items per page, the 'select' part of the SQL, the part of the SQL excluding 'select', and the query parameters. In most cases, this API suffices. Here's an example:")]),t._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[t._v("dao"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("paginate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select *"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"from girl where age > ? and weight < ?"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-paginate-with-sql-having-an-outermost-group-by"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-paginate-with-sql-having-an-outermost-group-by"}},[t._v("#")]),t._v(" 2. paginate with sql having an outermost group by")]),t._v(" "),e("p",[t._v("API prototype: "),e("code",[t._v("paginate(int pageNumber, int pageSize, boolean isGroupBySql, String select, String sqlExceptSelect, Object... paras)")]),t._v(". Compared to the first type, this one just has an extra boolean "),e("code",[t._v("isGroupBySql")]),t._v(" parameter. Here's an example:")]),t._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[t._v("dao"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("paginate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select *"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"from girl where age > ? group by age"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("In the above code, the outermost SQL contains a "),e("code",[t._v("group by age")]),t._v(", so the "),e("code",[t._v("isGroupBySql")]),t._v(" parameter should be set to true.")]),t._v(" "),e("p",[t._v("For nested SQL where the "),e("code",[t._v("group by")]),t._v(" isn't in the outermost layer, the parameter must be false, e.g., "),e("code",[t._v("select * from (select x from t group by y) as temp")]),t._v(".")]),t._v(" "),e("p",[t._v("Emphasizing once more: the "),e("code",[t._v("isGroupBy")]),t._v(" parameter should be true only when the outermost SQL has a "),e("code",[t._v("group by")]),t._v(" clause. If only the inner SQL in nested queries has a "),e("code",[t._v("group by")]),t._v(", then it should be false.")]),t._v(" "),e("h3",{attrs:{id:"_3-paginatebyfullsql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-paginatebyfullsql"}},[t._v("#")]),t._v(" 3. paginateByFullSql")]),t._v(" "),e("p",[t._v("API prototype: "),e("code",[t._v("paginateByFullSql(int pageNumber, int pageSize, String totalRowSql, String findSql, Object... paras)")]),t._v(".")]),t._v(" "),e("p",[t._v("This separates the two SQLs used for getting the total row count and fetching the data. It's mainly used for handling situations where there are complex "),e("code",[t._v("order by")]),t._v(" clauses or when "),e("code",[t._v("select")]),t._v(" contains distinct. You should only use this API when the first paginate method throws exceptions. Here's an example:")]),t._v(" "),e("div",{staticClass:"language-java line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" from "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"from girl where age > ?"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" totalRowSql "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select count(*) "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" from"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" findSql "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"select * "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" from "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('" order by age"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndao"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("paginateByFullSql")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" totalRowSql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" findSql"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("The key with "),e("code",[t._v("paginateByFullSql")]),t._v(" is that both "),e("code",[t._v("totalRowSql")]),t._v(" and "),e("code",[t._v("findSql")]),t._v(" should be able to use the last parameter, "),e("code",[t._v("Object... paras")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"_4-paginate-with-sqlpara-parameter"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-paginate-with-sqlpara-parameter"}},[t._v("#")]),t._v(" 4. paginate with SqlPara Parameter")]),t._v(" "),e("p",[t._v("API prototype: "),e("code",[t._v("paginate(int pageNumber, int pageSize, SqlPara sqlPara)")]),t._v(". This is meant to be used in conjunction with SQL management functionality, which will be discussed in the SQL management section.")]),t._v(" "),e("h3",{attrs:{id:"_5-common-issues-and-solutions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-common-issues-and-solutions"}},[t._v("#")]),t._v(" 5. Common Issues and Solutions")]),t._v(" "),e("p",[t._v("To effectively highlight and address issues, we first need to understand the underlying implementation principles of paginate.")]),t._v(" "),e("p",[t._v("The core principle is that JFinal will use the provided "),e("code",[t._v("select")]),t._v(" and "),e("code",[t._v("sqlExceptSelect")]),t._v(" strings to generate the SQL needed to compute the total rows that match the query conditions. The "),e("code",[t._v("order by")]),t._v(" clause, if present, is removed since many databases don't support it in "),e("code",[t._v("count(*)")]),t._v(" type queries and because it doesn't change the result.")]),t._v(" "),e("p",[t._v("Issues arise when:")]),t._v(" "),e("ol",[e("li",[t._v("The "),e("code",[t._v("select")]),t._v(" part of the query contains placeholders. This can be solved by wrapping the original SQL in an outer query.")]),t._v(" "),e("li",[t._v("The "),e("code",[t._v("order by")]),t._v(" clause contains subqueries or function calls. In this case, the solution is to use "),e("code",[t._v("paginateByFullSql")]),t._v(" which lets users specify the total row count and data fetching SQLs separately.")])]),t._v(" "),e("p",[t._v("In summary, understanding the inner workings of "),e("code",[t._v("paginate")]),t._v(" makes troubleshooting straightforward. If all else fails, "),e("code",[t._v("paginateByFullSql")]),t._v(" is the go-to solution, albeit at the cost of writing a bit more code.")])])}),[],!1,null,null,null);e.default=n.exports}}]);