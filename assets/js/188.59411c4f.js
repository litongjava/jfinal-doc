(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{551:function(s,a,e){"use strict";e.r(a);var n=e(14),r=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_5-12-oracle支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-12-oracle支持"}},[s._v("#")]),s._v(" 5.12 Oracle支持")]),s._v(" "),a("p",[s._v("Oracle数据库具有一定的特殊性，JFinal针对这些特殊性进行了一些额外的支持以方便广大的Oracle使用者。以下是一个完整的Oracle配置示例：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('public class DemoConfig extends JFinalConfig {\n  public void configPlugin(Plugins me) {\n    DruidPlugin dp = new DruidPlugin(……);\n    me.add(dp);\n    //配置Oracle驱动，使用 DruidPlugin 时可以省略下面这行配置\n    dp.setDriverClass("oracle.jdbc.driver.OracleDriver");\n    \n    ActiveRecordPlugin arp = new ActiveRecordPlugin(dp);\n    me.add(arp);\n    // 配置Oracle方言\n    arp.setDialect(new OracleDialect());\n    // 配置属性名(字段名)大小写不敏感容器工厂\n    arp.setContainerFactory(new CaseInsensitiveContainerFactory());\n    arp.addMapping("user", "user_id", User.class);\n  }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("由于Oracle数据库会自动将属性名(字段名)转换成大写，所以需要手动指定主键名为大写，如：arp.addMaping(“user”, “ID”, User.class)。如果想让ActiveRecord对属性名（字段名）的大小写不敏感可以通过设置CaseInsensitiveContainerFactory来达到，有了这个设置，则arp.addMaping(“user”, “ID”, User.class)不再需要了。")]),s._v(" "),a("p",[s._v("另外，Oracle并未直接支持自增主键，JFinal为此提供了便捷的解决方案。要让Oracle支持自动主键主要分为两步：一是创建序列，二是在model中使用这个序列，具体办法如下：\n1：通过如下办法创建序列，本例中序列名为：MY_SEQ")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CREATE SEQUENCE MY_SEQ\n INCREMENT BY 1\n MINVALUE 1\n MAXVALUE 9999999999999999\n START WITH 1\n CACHE 20;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("2：在YourModel.set(…)中使用上面创建的序列")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 创建User并使用序列\nUser user = new User().set("id", "MY_SEQ.nextval").set("age", 18);\nuser.save();\n// 获取id值\nInteger id = user.get("id");\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("序列的使用很简单，只需要 yourModel.set(主键名, 序列名 + “.nextval”)就可以了。特别注意这里的 “.nextval” 后缀一定要是小写，OracleDialect对该值的大小写敏感。")]),s._v(" "),a("p",[s._v("注意：Oracle下分页排序Sql语句必须满足2个条件：")]),s._v(" "),a("p",[s._v("Sql语句中必须有排序条件；")]),s._v(" "),a("p",[s._v("排序条件如果没有唯一性，那么必须在后边跟上一个唯一性的条件，比如主键")]),s._v(" "),a("p",[s._v("相关博文：http://database.51cto.com/art/201010/231533.htm")]),s._v(" "),a("p",[s._v("相关反馈：http://www.jfinal.com/feedback/64#replyContent")])])}),[],!1,null,null,null);a.default=r.exports}}]);