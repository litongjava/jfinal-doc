(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{541:function(s,e,n){"use strict";n.r(e);var a=n(14),r=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"_5-11-复合主键"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-11-复合主键"}},[s._v("#")]),s._v(" 5.11 复合主键")]),s._v(" "),e("p",[s._v("JFinal ActiveRecord 从 2.0 版本开始，采用极简设计支持复合主键，对于 Model 来说需要在映射时指定复合主键名称，以下是具体例子：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('ActiveRecordPlugin arp = new ActiveRecordPlugin(druidPlugin);\n// 多数据源的配置仅仅是如下第二个参数指定一次复合主键名称\narp.addMapping("user_role", "userId, roleId", UserRole.class);\n \n//同时指定复合主键值即可查找记录\nUserRole.dao.findByIds(123, 456);\n \n//同时指定复合主键值即可删除记录\nUserRole.dao.deleteByIds(123, 456);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("如上代码所示，对于Model来说，只需要在添加Model映射时指定复合主键名称即可开始使用复合主键，在后续的操作中JFinal会对复合主键支持的个数进行检测，当复合主键数量不正确时会报异常，尤其是复合主键数量不够时能够确保数据安全。复合主键不限定只能有两个，可以是数据库支持下的任意多个。")]),s._v(" "),e("p",[s._v("对于 Db + Record 模式来说，复合主键的使用不需要配置，直接用即可：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Db.findByIds("user_role", "roleId, userId", 123, 456);\nDb.deleteByIds("user_role", "roleId, userId", 123, 456);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);