(window.webpackJsonp=window.webpackJsonp||[]).push([[186],{552:function(s,e,n){"use strict";n.r(e);var a=n(14),l=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"_5-10-表关联操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-10-表关联操作"}},[s._v("#")]),s._v(" 5.10 表关联操作")]),s._v(" "),e("p",[s._v("JFinal ActiveRecord 天然支持表关联操作，并不需要学习新的东西，此为无招胜有招。表关联操作主要有两种方式：一是直接使用sql得到关联数据；二是在Model中添加获取关联数据的方法。")]),s._v(" "),e("p",[s._v("假定现有两张数据库表：user、blog，并且user到blog是一对多关系，blog表中使用user_id关联到user表。如下代码演示使用第一种方式得到user_name：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('public void relation() {\n  String sql = "select b.*, u.user_name from blog b inner join user u on b.user_id=u.id where b.id=?";\n  Blog blog = Blog.dao.findFirst(sql, 123);\n  String name = blog.getStr("user_name");\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("以下代码演示第二种方式在Blog中获取相关联的User以及在User中获取相关联的Blog：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('public class Blog extends Model<Blog>{\n    public static final Blog dao = new Blog().dao();\n    \n    public User getUser() {\n       return User.dao.findById(get("user_id"));\n    }\n}\n \npublic class User extends Model<User>{\n    public static final User dao = new User().dao();\n    \n    public List<Blog> getBlogs() {\n       return Blog.dao.find("select * from blog where user_id=?", get("id"));\n    }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("上面代码在具体的 Model 中 new 了一个 dao 对象出来，这种用法仅用于表关联操作，其它情况的 dao 对象应该让 Service 层持有。")])])}),[],!1,null,null,null);e.default=l.exports}}]);